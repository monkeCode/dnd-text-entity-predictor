# NER for Dungeons & Dragons Entities

End-to-end –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π (NER) –≤ —Ç–µ–∫—Å—Ç–∞—Ö –ø–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π Dungeons & Dragons.

[![Python Version](https://img.shields.io/badge/python-3.12%2B-blue)](https://www.python.org/)
[![PyTorch](https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?logo=PyTorch&logoColor=white)](https://pytorch.org/)
[![Transformers](https://img.shields.io/badge/ü§ó-Transformers-yellow)](https://huggingface.co/docs/transformers/index)
[![FastAPI](https://img.shields.io/badge/FastAPI-005571?logo=fastapi)](https://fastapi.tiangolo.com/)

## üìã –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

- [x] –ü–∞–π–ø–ª–∞–π–Ω —Å–±–æ—Ä–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- [x] –û–±—É—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π
- [x] –î–µ–ø–ª–æ–π –º–æ–¥–µ–ª–∏ –∫–∞–∫ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–∞
- [ ] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD

## üõ†Ô∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ó–∞–¥–∞—á–∞                          | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è                                     |
| :------------------------------ | :--------------------------------------------- |
| **–°–±–æ—Ä –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö** | `requests`, `pandas`, `beautifulsoup4`         |
| **EDA**                         | `jupyter`, `matplotlib`, `seaborn`             |
| **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**            | `pytorch`, `pytorch-lightning`, `transformers` |
| **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**      | `DVC`                                          |
| **–í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫**               | `FastAPI`                                      |
| **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**             | `Docker` (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)                          |
| **CI/CD**                       | `GitHub Actions` (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)                  |

## üöÄ –ú–æ—Ç–∏–≤–∞—Ü–∏—è

–í –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–π —Ä–æ–ª–µ–≤–æ–π –∏–≥—Ä–µ Dungeons and Dragons (D&D) –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞—Å—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –ø–æ –º–Ω–æ–≥–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º –∫–Ω–∏–≥–∞–º, –∏ –∫–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ ‚Äî **–ó–∞–∫–ª–∏–Ω–∞–Ω–∏—è**, **–ú–æ–Ω—Å—Ç—Ä—ã** –∏ **–ú–∞–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã** ‚Äî —á–∞—Å—Ç–æ —Å—Å—ã–ª–∞—é—Ç—Å—è –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞. –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã NER –æ–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–ª–æ—Ö–æ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ —Å–≤—è–∑—ã–≤–∞–Ω–∏—è —ç—Ç–∏—Ö —É–∑–∫–æ—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π.

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ D&D-—Å—É—â–Ω–æ—Å—Ç–µ–π –∏–∑ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤—è–∑–∞–Ω–Ω–æ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π –∏–ª–∏ –±—ã—Å—Ç—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º.

## üóÉÔ∏è –î–∞–Ω–Ω—ã–µ

–î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã –ø—É—Ç–µ–º –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü —Ä–µ—Å—É—Ä—Å–æ–≤ [dnd.su](https://dnd.su/) –∏ [pathfinder.family](https://pathfinder.family/), –≥–¥–µ —Å—É—â–Ω–æ—Å—Ç–∏ —É–∂–µ —Ä–∞–∑–º–µ—á–µ–Ω—ã –≥–∏–ø–µ—Ä—Å—Å—ã–ª–∫–∞–º–∏.

**–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è:** –î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã —Å—Å—ã–ª–æ–∫ (`"–ö—Ä–∞—Å–Ω—ã–π –¥—Ä–∞–∫–æ–Ω [Red Dragon]"`) –±—ã–ª–∏ –∞—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –±–µ–∑ –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –≤ —Å–∫–æ–±–∫–∞—Ö (`"–ö—Ä–∞—Å–Ω—ã–π –¥—Ä–∞–∫–æ–Ω"`).

**–°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:**
–ú–µ—Ç—Ä–∏–∫–∏ –≤ –ø–µ—Ä–≤—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ –ø–ª–æ—Ö–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Å—É—â–Ω–æ—Å—Ç—è—Ö, —Ä–∞–Ω–µ–µ –Ω–µ –≤—Å—Ä–µ—á–∞–µ–º—ã—Ö –≤ –æ–±—É—á–µ–Ω–∏–∏, –∞ —Ç–∞–∫–∂–µ –≤ —Ç–µ–∫—Å—Ç–∞—Ö, —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ª–∏—á–∞—é—â–∏—Ö—Å—è –æ—Ç —Ç–µ–∫—Å—Ç–æ–≤ –ø—Ä–∞–≤–∏–ª.
–ü–æ—ç—Ç–æ–º—É –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
–î–∞–Ω–Ω—ã–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑:

- API YaGPT 5.1 ~ 50–∫ —Ç–µ–∫—Å—Ç–æ–≤
- –ª–æ–∫–∞–ª—å–Ω–æ –ø–æ–¥–Ω—è—Ç—É—é Phi 4 ~ 6–∫ —Ç–µ–∫—Å—Ç–æ–≤

<details>
<summary>–ü—Ä–æ–º–ø—Ç</summary>

```md
—Ç—ã –º–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ–∫—Å—Ç–æ–≤ –ø–æ –¥–Ω–¥, —Ç–µ–±–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å 5 –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤ —Ç–µ–∫—Å—Ç–æ–≤ –≤ –¥–Ω–¥ —Ç–µ–º–∞—Ç–∏–∫–µ —Å –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ–º –º–æ–Ω—Å—Ç–≤–æ–≤, –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –∏–ª–∏ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ. –∫–∞–∂–¥—ã–π —Ç–∞–∫–æ–π –æ–±—ä–µ–∫—Ç –ø–æ–º–µ—á–∞–π –∫–∞–∫ —Å—Å—ã–ª–∫—É –≤ makrdown –∏ –≤ –∫—Ä—É–≥–ª—ã—Ö —Å–∫–æ–±–∫–∞—Ö –ø–∏—à–∏, —á—Ç–æ —ç—Ç–æ –∑–∞ –æ–±—ä–µ–∫—Ç (SPELL, MONSTER, ITEM)

–ü–†–ò–ú–ï–† –û–§–û–ú–õ–ï–ù–ò–Ø –û–ë–™–ï–ö–¢–û–í:
[–í–æ–ª—à–µ–±–Ω–∞—è —Å—Ç—Ä–µ–ª–∞](SPELL)
[–í—ã—Å—à–∏–π –≤–∞–º–ø–∏—Ä](MOSTER)
[–ß—É–¥–µ—Å–Ω—ã–µ –∫—Ä–∞—Å–∫–∏](ITEM)

–æ—Ç–≤–µ—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ json –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –ø—Ä–∏–º–µ—Ä—É :
{
"reasoning": "–Ø –∏—Å–ø–æ–ª—å–∑—É—é —Ç–∞–∫–∏–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è, –∫–∞–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∑–ª–∞ –∏ –¥–æ–±—Ä–∞, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –º–∞–≥–∏–∏ –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∂–µ–ª–∞–Ω–∏–π, –º–æ–Ω—Å—Ç—Ä–æ–≤ –ª–µ—Ç—É—á–∏—Ö –º—ã—à–µ–π, –≤–æ–ª–∫–æ–≤ –∏ —Ä–æ–π –∫—Ä—ã—Å, –∞ —Ç–∞–∫–∂–µ –º–∞–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã: —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—å –∏ –º–∞—Å–ª–æ —ç—Ñ–∏—Ä–Ω–æ—Å—Ç–∏, –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å 5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –∏ —Å–¥–µ–ª–∞—Ç—å –∏—Ö –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏ –ø–æ —Å–æ—Å—Ç–∞–≤—É –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –ª–æ–≥–∏—á–Ω—ã–º–∏ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏"
"sentenses": [ " –í –ª—é–±–æ–µ –≤—Ä–µ–º—è –≤–æ –≤—Ä–µ–º—è –≤–∞—à–µ–≥–æ —Ö–æ–¥–∞ [—Å—Ñ–µ—Ä–∞](ITEM) –º–æ–∂–µ—Ç –Ω–∞–ª–æ–∂–∏—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ [–≤–Ω—É—à–µ–Ω–∏–µ](SPELL) (–°–ª —Å–ø–∞—Å–±—Ä–æ—Å–∫–∞ 17), –Ω–∞—Ü–µ–ª–µ–Ω–Ω–æ–µ –Ω–∞ –≤–∞—Å –∏–ª–∏ –¥—Ä—É–≥–æ–µ —Å—É—â–µ—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –∫–æ—Å–Ω—É–ª–æ—Å—å —à–∞—Ä–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 24 —á–∞—Å–æ–≤. –≠—Ç–æ [—Å–∏–ª–∞ —Å—Ñ–µ—Ä—ã](ITEM), –∫–æ—Ç–æ—Ä—É—é –≤—ã –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç–µ.",
"–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ: [–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã –∫–∞–º–Ω—è](SPELL) , [–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∑–ª–∞ –∏ –¥–æ–±—Ä–∞](SPELL) , [–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –º–∞–≥–∏–∏](SPELL)",
"–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã –∂—Ä–µ—Ü 3-–≥–æ —É—Ä–æ–≤–Ω—è, —Ç–æ —É –≤–∞—Å –µ—Å—Ç—å —á–µ—Ç—ã—Ä–µ —è—á–µ–π–∫–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π 1-–≥–æ —É—Ä–æ–≤–Ω—è –∏ –¥–≤–µ —è—á–µ–π–∫–∏ 2-–≥–æ —É—Ä–æ–≤–Ω—è. –ü—Ä–∏ –ú—É–¥—Ä–æ—Å—Ç–∏ 16 –≤–∞—à —Å–ø–∏—Å–æ–∫ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π –º–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–µ–±—è —à–µ—Å—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π 1-–≥–æ –∏–ª–∏ 2-–≥–æ —É—Ä–æ–≤–Ω—è –≤ –ª—é–±–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏. –ï—Å–ª–∏ –≤—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ 1-–≥–æ —É—Ä–æ–≤–Ω—è [–ª–µ—á–µ–Ω–∏–µ —Ä–∞–Ω](SPELL), –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–ª–æ–∂–∏—Ç—å –µ–≥–æ, –∏—Å–ø–æ–ª—å–∑—É—è —è—á–µ–π–∫—É 1-–≥–æ —É—Ä–æ–≤–Ω—è –∏–ª–∏ —è—á–µ–π–∫—É 2-–≥–æ —É—Ä–æ–≤–Ω—è. –ù–∞–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –Ω–µ —É–¥–∞–ª—è–µ—Ç –µ–≥–æ –∏–∑ —Å–ø–∏—Å–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π.",
"–î–µ—Ç–∏ –Ω–æ—á–∏ (1/–¥–µ–Ω—å). –í–∞–º–ø–∏—Ä –º–∞–≥–∏—á–µ—Å–∫–∏–º –æ–±—Ä–∞–∑–æ–º –ø—Ä–∏–∑—ã–≤–∞–µ—Ç 2–∫4 [—Ä–æ—è –∫—Ä—ã—Å](MONSTER) –∏–ª–∏ [–ª–µ—Ç—É—á–∏—Ö –º—ã—à–µ–π](MONSTER, –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –Ω–∞ –Ω–µ–±–µ –Ω–µ—Ç —Å–æ–ª–Ω—Ü–∞. –ù–∞—Ö–æ–¥—è—Å—å –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–æ–∑–¥—É—Ö–µ, –≤–∞–º–ø–∏—Ä –º–æ–∂–µ—Ç –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –ø—Ä–∏–∑–≤–∞—Ç—å 3–∫6 [–≤–æ–ª–∫–æ–≤](MONSTER). –í—ã–∑–≤–∞–Ω–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∏—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ 1–∫4 —Ä–∞—É–Ω–¥–∞, –¥–µ–π—Å—Ç–≤—É—é—Ç –∫–∞–∫ —Å–æ—é–∑–Ω–∏–∫–∏ –≤–∞–º–ø–∏—Ä–∞ –∏ –ø–æ–¥—á–∏–Ω—è—é—Ç—Å—è –µ–≥–æ —É—Å—Ç–Ω—ã–º –∫–æ–º–∞–Ω–¥–∞–º. –ó–≤–µ—Ä–∏ –æ—Å—Ç–∞—é—Ç—Å—è –Ω–∞ 1 —á–∞—Å, –ø–æ–∫–∞ –≤–∞–º–ø–∏—Ä –Ω–µ —É–º—Ä–µ—Ç, –∏–ª–∏ –ø–æ–∫–∞ –≤–∞–º–ø–∏—Ä –Ω–µ –æ—Ç–ø—É—Å—Ç–∏—Ç –∏—Ö –±–æ–Ω—É—Å–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º.",
"–≠—Ç–∞ —Ç—è–≥—É—á–∞—è, –º–æ–ª–æ—á–Ω–æ-–±–µ–ª–∞—è —Å—É–±—Å—Ç–∞–Ω—Ü–∏—è –º–æ–∂–µ—Ç —Å–∫–ª–µ–∏—Ç—å –¥–≤–∞ –ª—é–±—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–∞. –û–Ω–∞ –¥–æ–ª–∂–Ω–∞ —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ —Å–æ—Å—É–¥–µ –∏–ª–∏ —Ñ–ª—è–≥–µ, –ø–æ–∫—Ä—ã—Ç–æ–π –∏–∑–Ω—É—Ç—Ä–∏ [–º–∞—Å–ª–æ–º —Å–∫–æ–ª—å–∂–µ–Ω–∏—è](ITEM). –í –Ω–∞–π–¥–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è 1–∫6 + 1 —É–Ω—Ü–∏—è –∫–ª–µ—è. –û–¥–Ω–∞ —É–Ω—Ü–∏—è –∫–ª–µ—è –º–æ–∂–µ—Ç –ø–æ–∫—Ä—ã—Ç—å 1 –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π —Ñ—É—Ç –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏. –ö–ª–µ–π –∑–∞—Ç–≤–µ—Ä–¥–µ–≤–∞–µ—Ç —á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–≤—è–∑—å –¥–≤—É—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –º–æ–∂–Ω–æ —Ä–∞–∑–æ—Ä–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞–Ω–µ—Å–µ–Ω–∏–µ–º [—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—è](ITEM) –∏–ª–∏ [–º–∞—Å–ª–∞ —ç—Ñ–∏—Ä–Ω–æ—Å—Ç–∏](ITEM), –ª–∏–±–æ –∂–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ–º [–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∂–µ–ª–∞–Ω–∏–π](ITEM)."]
}

–Ω–µ –ø–∏—à–∏ –Ω–∏–∫–∞–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –≤–Ω–µ —ç—Ç–æ–≥–æ json, —Ç–≤–æ–π –æ—Ç–≤–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
```

–ú–æ–¥–µ–ª—å —Ç–∞–∫–∂–µ –ø–æ–ª—É—á–∞–ª–∞ –Ω–∞ –≤—Ö–æ–¥ 9 —Å—É—â–Ω–æ—Å—Ç–µ–π (–ø–æ 3 –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞) –∏ –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –≤ —Ç–µ–∫—Å—Ç–∞—Ö.

</details>

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞:**

- **–û–±—â–∏–π –æ–±—ä–µ–º –∞—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:** 72663 —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
- **–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å—É—â–Ω–æ—Å—Ç–µ–π:** 47643
- **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–ª–∞—Å—Å–∞–º:**
  - –ó–∞–∫–ª–∏–Ω–∞–Ω–∏–µ (Spell): `36452`
  - –ú–æ–Ω—Å—Ç—Ä (Monster): `9692`
  - –ú–∞–≥–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–¥–º–µ—Ç (Item): `1499`
- **–†–∞–∑–±–∏–µ–Ω–∏–µ:** Train/Validation/Test = 80%/10%/10%

–í Train –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –∏—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä train –≤—ã–±–æ—Ä–∫–∏: `110552`

**–ü—Ä–∏–º–µ—Ä —Ä–∞–∑–º–µ—á–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞:**

```json
{
  "text": "–ò–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ –í–æ–ª—à–µ–±–Ω–∞—è —Å—Ç—Ä–µ–ª–∞, —á—Ç–æ–±—ã –ø–æ—Ä–∞–∑–∏—Ç—å –ö–æ–±–æ–ª—å–¥–∞ [Cobold], –∫–æ—Ç–æ—Ä—ã–π –¥–µ—Ä–∂–∏—Ç –ü–æ—Å–æ—Ö –ø–∞—É–∫–∞.",
  "annotations": [
    { "start": 32, "end": 47, "label": "SPELL" },
    { "start": 67, "end": 75, "label": "MONSTER" },
    { "start": 90, "end": 103, "label": "ITEM" }
  ]
}
```

## üß† –ú–æ–¥–µ–ª—å

–í –æ—Å–Ω–æ–≤–µ —Ä–µ—à–µ–Ω–∏—è ‚Äî –¥–æ–æ–±—É—á–µ–Ω–Ω–∞—è —è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å **BERT** (`cointegrated/rubert-tiny2` –∏ `DeepPavlov/bert-base-bg-cs-pl-ru-cased`), –Ω–∞–¥ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞–¥—Å—Ç—Ä–æ–µ–Ω –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–∫–µ–Ω–æ–≤.

–ë—ã–ª–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–æ –¥–≤–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞:

1. **–ê–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–∞—è:** –£—á–∏—Ç—ã–≤–∞–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥ —Ç–µ–∫—É—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç–æ–∫–µ–Ω–∞.
2. **–ù–µ–∞–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–∞—è:** –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω—ã –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –æ—Ç BERT.

**–§–∏–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ú–æ–¥–µ–ª–∏ —Å –∞–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–º –∏–ª–∏ CRF –ø–æ–¥—Ö–æ–¥–æ–º –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –≤–∞–ª–∏–¥–µ–π—Ç–µ, –Ω–æ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–æ–±—É—á–∞–ª–∏—Å—å –∏ –ø—Ä–æ—Å–µ–¥–∞–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–µ, –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤

**–ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä                       | –ó–Ω–∞—á–µ–Ω–∏–µ                                                                 |
| :----------------------------- | :----------------------------------------------------------------------- |
| **–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å**             | `cointegrated/rubert-tiny2` –∏–ª–∏ `DeepPavlov/bert-base-bg-cs-pl-ru-cased` |
| **Learning Rate**              | 1e-5                                                                     |
| **Batch Size**                 | 32                                                                       |
| **Epochs**                     | 50                                                                       |
| **Dropout Rate**               | 0.1                                                                      |
| **Hidden Dim (–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä)** | 256                                                                      |
| **–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä**                | AdamW                                                                    |

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –º–µ—Ç—Ä–∏–∫–∏

–ú–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∏–≤–∞–ª–∞—Å—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º **Precision, Recall –∏ F1-score** (macro-average).

### –û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–æ–¥–µ–ª—å                                              | Precision | Recall | F1-score |
| :-------------------------------------------------- | :-------: | :----: | :------: |
| `bert-base-bg-cs-pl-ru-cased` + Baseline Classifier |  0.8221   | 0.8469 |  0.8333  |
| `rubert-tiny2` + Baseline Classifier                |  0.7698   | 0.8677 |  0.8138  |

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ –ø–æ –∫–ª–∞—Å—Å–∞–º (–ª—É—á—à–∞—è –º–æ–¥–µ–ª—å)

| –ö–ª–∞—Å—Å         | Precision | Recall | F1-score |
| :------------ | :-------: | :----: | :------: |
| **B-SPELL**   |  0.9214   | 0.9693 |  0.9447  |
| **I-SPELL**   |  0.9046   | 0.9824 |  0.9419  |
| **B-MONSTER** |  0.7657   | 0.7077 |  0.7355  |
| **I-MONSTER** |  0.7976   | 0.7736 |  0.7854  |
| **B-ITEM**    |  0.6744   | 0.6904 |  0.6823  |
| **I-ITEM**    |  0.6937   | 0.8112 |  0.7479  |

## üöÄ –î–µ–ø–ª–æ–π

–ú–æ–¥–µ–ª—å –æ–±–µ—Ä–Ω—É—Ç–∞ –≤ REST API —Å–µ—Ä–≤–∏—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ **FastAPI**.

**–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞:**

```bash
python model_service.py
```

**–≠–Ω–¥–ø–æ–∏–Ω—Ç `POST /predict`**

- **–ó–∞–ø—Ä–æ—Å:**

```json
{
  "batch": [
    { "id": 0, "text": "–í–æ–∏–Ω –∞—Ç–∞–∫—É–µ—Ç –¥–≤—É—Ä—É—á–Ω—ã–º –º–µ—á–æ–º." },
    {
      "id": 1,
      "text": "–ú–∞–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ó–∞–≥–æ–≤–æ—Ä [–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä] –∏ –ø—Ä–∏–∑—ã–≤–∞–µ—Ç –°–∫–µ–ª–µ—Ç–∞."
    }
  ]
}
```

- **–û—Ç–≤–µ—Ç:**

```json
{
  "results": [
    {
      "id": 0,
      "predictions": []
    },
    {
      "id": 1,
      "predictions": [
        { "start": 24, "end": 38, "label": "SPELL", "text": "–û–≥–Ω–µ–Ω–Ω—ã–π —à–∞—Ä" },
        { "start": 56, "end": 63, "label": "MONSTER", "text": "–°–∫–µ–ª–µ—Ç–∞" }
      ]
    }
  ]
}
```

## –ò—Ç–æ–≥–æ–≤—ã–π –ø–∞–π–ø–ª–∞–π–Ω

```mermaid
flowchart TD
        node2["data/lmstudio_responses.csv.dvc"]
        node3["data/ya_generated.csv.dvc"]
        node4["dowload_pages"]
        node5["make_annotations"]
        node6["make_datasets"]
        node7["pathfinder_downloader"]
        node8["prepare_syntetic_data"]
        node9["train"]
        node2-->node8
        node3-->node8
        node4-->node5
        node5-->node6
        node6-->node9
        node7-->node5
        node8-->node6
```

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞, –∑–∞–ø—É—Å–∫ –∏ –æ–±—É—á–µ–Ω–∏–µ

### Bare metall

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**

   ```bash
   git clone https://github.com/monkeCode/dnd-text-entity-predictor.git
   cd dnd-text-entity-predictor
   ```

2. **–†–µ–ø—Ä–æ–¥—É–∫—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è:**

   ```bash
   dvc exp run
   ```

3. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞:**

   ```bash
   python model_service.py models/model.pth
   ```

### Docker container

`TODO`

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000/docs`
